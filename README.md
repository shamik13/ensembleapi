# ensembleapi
CLI tool for easily ensemble results generated by multiple models in Project-S.

## How to install?
```
pip install git+https://github.com/shamik13/ensembleapi.git@cli
```
**NOTE:** SSH access to `meshify` is required. If you don't have SSH access to `meshify`, please contact @inoue-san.

## Features:

#### Upload Dataset:
In order to calculate ROCAUC score / ensemble ROCAUC score, first step is to upload the dataset. This is required only once per dataset. Once the dataset is uploaded, it can be referred by it's name.  The dataset should contain two columns, `stem` and `label`. More details about these two columns can be found in `somic-data` repository.

```
>>> ensembleapi upload-dataset -dn <unique-name-of-the-dataset> -cp <absolute/path/of/csv/file>
```
For example, `ensembleapi upload-dataset -dn rav4testdata -cp /home/shamik/Downloads/data.csv`


#### Upload Model predictions:
There might be a scenario where many people are working on different models using the same dataset. In that case, the results of different models are not easily available to each person. To solve this issue, anyone can upload model predictions to server along with the model name and the dataset name. After that, it can be referred by anyone while ensembling with their results. The model prediction CSV should contain two columns, `stem` and `score`. 

```
>>> ensembleapi upload-roc-csv -dn <dataset-name> -mn <model-name> -cp <absolute/path/of/model/prediction/csv>
```
For example, `ensembleapi upload-roc-csv -dn rav4testdata -mn padim -cp /home/shamik/Downloads/padim_roc.csv`

#### Ensembling:
The ensembling feature supports a few scenarios:
- If a single file/model name is provided, simple ROC score will be calculated.
- If multiple files/model names are provided without any weights, ensemble will be done by default weights.
- If multiple files/model names are provided with weights for each files/models, ensemble will be done with the given weights.
```
>>> ensembleapi make-ensemble -cp <absolute/path/to/predcition/csv,model-name> -dn <dataset-name> -w <weight1,weight2>
```
For example, 
- Case 1: `ensembleapi make-ensemble -cp /home/shamik/work/a.csv -dn rav4dataset`
- Case 2: `ensembleapi make-ensemble -cp /home/shamik/work/padim_roc.csv,patchcore -dn rav4dataset`
- Case 3: `ensembleapi make-ensemble -cp /home/shamik/work/padim_roc.csv,patchcore,draem -dn rav4dataset -w 0.5,0.3,0.2`

#### View available datasets/models:
The purpose of this command is to see what models are available on server to be used directly in `make-ensemble` command.
```
>>> ensembleapi get-model-list -dn <optional/dataset-name>
```
For example,
- `ensembleapi get-model-list`
- `ensembleapi get-model-list -dn rav4dataset`
